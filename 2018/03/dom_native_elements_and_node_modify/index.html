<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    <title>Javascript 原生创建和修改 DOM 节点的方法 | TryCatch</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
        <meta name="keywords" content="DOM,node,element,HTML" />
    
    

    

    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/titillium-web/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.0.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <script type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-92905809-1', 'auto');
ga('send', 'pageview');

</script>
    
    
        <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?409648b1638886ada0891d05cc80dc19";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    
    
        <script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
    
    

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>

<body>
  <div id="root">
    <div id="page-percent">
      <div></div>
    </div>
    <div id="wrap">
      <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div id="header-nav" class="nav-container">
                <div class="container-inner nav-container-inner">
                    <ul id="main-nav">
                        
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">主页</a>
                                </li>
                        
                                <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Uncategory/">Uncategory</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/css/">css</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/html/">html</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/js/">js</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/翻译/">翻译</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/转载/">转载</a></li></ul>
                            
                    </ul>
                </div>
            </div>
            <div id="header-title" style="display: none">
                <div class="container-inner">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                        <h2 class="subtitle-wrap">
                            <p class="subtitle">To try, then catch.</p>
                        </h2>
                    
                </div>
            </div>
        </div>
    </div>
</header>
      <div class="container">
        <div class="bg_content">
          <canvas id="canvas"></canvas>
        </div>
        <div class="main-body container-inner">
          <div class="main-body-inner">
            <section id="main">
              <div class="main-body-content">
                <article id="post-dom_native_elements_and_node_modify" class="article article-single article-type-post" itemscope itemprop="blogPost">
    
    
        <h1 class="article-title" itemprop="name">
        Javascript 原生创建和修改 DOM 节点的方法
        </h1>
    

    <header class="article-header" >
        <div class="article-author-avatar">
            <img src="/images/avatar.png" alt="Author's avatar">
        </div>
        <div class="article-subtitle">
            <div class="article-author">
                tcatche
            </div>
            <div class="article-meta">
                <a href="/2018/03/dom_native_elements_and_node_modify/" class="article-date">
    <i class="icon fa fa-calendar"></i>
    2018-03-13
</a>
                
    <span class="word-count">
      <i class="icon fa fa-file-text"></i>
      字数: 4,609 
    </span>
    <span class="word-count">
      <i class="icon fa fa-clock-o"></i>
      阅读时长: 19mins 
    </span>

            </div>
            <div class="article-dir">
                
    <div class="article-category">
    <i class="icon fa fa-list-ul"></i>
    <a class="article-category-link" href="/categories/js/">js</a>
    </div>

                
    <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DOM/">DOM</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HTML/">HTML</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/element/">element</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/node/">node</a></li></ul>

            </div>
        </div>
    </header>
    <div class="article-inner">
        
        <div class="article-entry" itemprop="articleBody">
            <p>本文总结了常用的 js 进行 DOM 修改的操作，主要总结节点的创建、修改和元素属性的管理的一些相关的操作。</p>
<h2 id="节点创建"><a href="#节点创建" class="headerlink" title="节点创建"></a>节点创建</h2><p>常用的和节点创建有关的接口主要有：<code>document.createElement</code>、<code>document.createTextNode</code> 、<code>document.createDocumentFragment</code> 、 <code>document.createAttribute</code> 、<code>document.adoptNode</code> 、<code>document.importNode</code> 、<code>node.cloneNode</code>。 </p>
<h3 id="document-createElement"><a href="#document-createElement" class="headerlink" title="document.createElement"></a>document.createElement</h3><p><code>document.createElement(tagName)</code> 这是我们最常用的一个方法了，创建由标签名称（<code>tagName</code>）指定的 HTML 元素，如果标签名称不是一个有效的 HTML 元素，不会报错，会创建一个 <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLUnknownElement" target="_blank" rel="external">HTMLUnknownElement对象</a>。</p>
<p>HTML 对大小写不敏感，所以使用大写或者小写的标签名称都可以，但是注意，标签中不能包含尖括号 <code>&lt;&gt;</code> ，否则会报错。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> newDiv = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line"><span class="keyword">var</span> newDiv = <span class="built_in">document</span>.createElement(<span class="string">'DIV'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.createElement(<span class="string">'&lt;div&gt;'</span>);</span><br><span class="line"><span class="comment">// Uncaught DOMException: Failed to execute 'createElement' on 'Document': The tag name provided ('&lt;div&gt;') is not a valid name.</span></span><br></pre></td></tr></table></figure>
<p>注意，通过 <code>createElement</code> 创建的元素，并未添加到 HTML 文档中，需要调用 <code>appendChild</code> 等节点修改方法将其添加到 HTML 文档树中。后几节创建的其他类型的节点也是如此，后文不再对此进行说明。</p>
<h3 id="document-createTextNode"><a href="#document-createTextNode" class="headerlink" title="document.createTextNode"></a>document.createTextNode</h3><p><code>document.createTextNode(text)</code> 创建一个文本节点，参数（<code>text</code>）为文本节点的内容。</p>
<p>这个方法返回的节点，被浏览器当作文本渲染，而不是当作 HTML 代码渲染，因此会对 HTML 代码进行转义，可以用来展示用户的输入，避免 <code>XSS</code> 攻击：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escapeUserInput</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> div = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">  div.appendChild(<span class="built_in">document</span>.createTextNode(str));</span><br><span class="line">  <span class="keyword">return</span> div.innerHTML;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> userInput = <span class="string">'&lt;p&gt;危险内容&lt;/p&gt;'</span>;</span><br><span class="line"><span class="keyword">var</span> template = <span class="string">'&lt;div&gt;'</span> + escapeUserInput(userInput) + <span class="string">'&lt;/div&gt;'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 此时被转义，危险内容不再危险</span></span><br><span class="line">&lt;div&gt;&amp;lt;p&amp;gt;危险内容&amp;lt;<span class="regexp">/p&amp;gt;&lt;/</span>div&gt;</span><br></pre></td></tr></table></figure>
<p>但是，该方法不对单引号和双引号转义，因此用来为属性赋值的时候，仍然会被 <code>XSS</code> 攻击：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> userInput = <span class="string">'" onmouseover="console.log(\'危险操作\')" "'</span>;</span><br><span class="line"><span class="keyword">var</span> template = <span class="string">'&lt;div color="'</span> + escapeUserInput(userInput) + <span class="string">'"&gt;user set color&lt;/div&gt;'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 被注入一个 onmouseover 操作</span></span><br><span class="line">&lt;div color=<span class="string">""</span> onmouseover=<span class="string">"console.log('危险操作')"</span> <span class="string">""</span>&gt;user set color&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="document-createDocumentFragment"><a href="#document-createDocumentFragment" class="headerlink" title="document.createDocumentFragment"></a>document.createDocumentFragment</h3><p><code>document.createDocumentFragment()</code> 方法创建一个新的 <code>DocumentFragment</code> 对象。</p>
<p><code>DocumentFragments</code> 存在于内存中，并不在 DOM 树存在，将元素插入到文档片段也不会引起回流。因此创建文档片段，并将复杂的 DOM 结构附加到文档片段中，然后将文档片段附加到 DOM 树，可以优化性能。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> ul = <span class="built_in">document</span>.getElementById(<span class="string">'list'</span>);</span><br><span class="line"><span class="keyword">var</span> domfrag = <span class="built_in">document</span>.createDocumentFragment();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i ++) &#123;</span><br><span class="line">  <span class="keyword">var</span> li = <span class="built_in">document</span>.createElement(<span class="string">'li'</span>);</span><br><span class="line">  li.textContent = i;</span><br><span class="line">  domfrag.appendChild(li);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ul.appendChild(domfrag);</span><br></pre></td></tr></table></figure>
<h3 id="document-createAttribute"><a href="#document-createAttribute" class="headerlink" title="document.createAttribute"></a>document.createAttribute</h3><p><code>document.createAttribute(attrName)</code> 方法创建并返回一个新的属性节点。这个方法不是很常用用，因为添加属性通常用 <code>node.setAttribute</code> 即可：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> node = <span class="built_in">document</span>.getElementById(<span class="string">'div'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> attr = <span class="built_in">document</span>.createAttribute(<span class="string">'attr'</span>);</span><br><span class="line">attr.nodeValue = <span class="string">'value'</span>;</span><br><span class="line">node.setAttributeNode(attr);</span><br><span class="line"><span class="comment">// 等价于</span></span><br><span class="line">node.setAttribute(<span class="string">'attr'</span>, <span class="string">'value'</span>);</span><br><span class="line"><span class="string">``</span><span class="string">` </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">### document.adoptNode </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="built_in">document</span>.adoptNode(externalNode)<span class="string">` 从其他的 document 中获取一个节点（`</span>externalNode<span class="string">`），并将该节点以及它的所有子节点从原文档删除, 并且它的 `</span>ownerDocument<span class="string">` 属性会变成当前的 document。之后你可以把这个节点插入到当前文档中，不常用，了解即可。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>js</span><br><span class="line"><span class="comment">// 该函数用来从本文档的第一个 iframe 中获取第一个 element 元素，</span></span><br><span class="line"><span class="comment">// 并插入到当前文档树中</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getEle</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> iframe = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"iframe"</span>)[<span class="number">0</span>],</span><br><span class="line">    ele = iframe.contentWindow.document.body.firstElementChild;</span><br><span class="line">  <span class="keyword">if</span>(ele)&#123;</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(<span class="built_in">document</span>.adoptNode(ele))</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    alert(<span class="string">"没有更多元素了"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"move"</span>).onclick = getEle</span><br></pre></td></tr></table></figure>
<p>注意，该方法在同一 document 下的不同两个元素中也可以使用，可以实现从左边栏列表中选取某些元素加载到右边栏的功能。</p>
<p>注意，如果节点资源来自不同的源的时候，调用 adoptNode 可能会失败。</p>
<p>有些情况下，将外部文档的节点插入当前文档之前,你需要使用 document.importNode() 从外部文档导入源节点，<a href="https://www.w3.org/DOM/faq.html#ownerdoc" target="_blank" rel="external">了解更多细节</a>。</p>
<h3 id="document-importNode"><a href="#document-importNode" class="headerlink" title="document.importNode"></a>document.importNode</h3><p><code>document.importNode(externalNode, deep)</code> 这个接口也不常用，作用是拷贝外部文档的一个节点（<code>externalNode</code>）。<code>deep</code> 表明是否要导入节点的后代节点，默认为 false 不导入后代节点。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> iframe = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"iframe"</span>)[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">var</span> oldNode = iframe.contentDocument.getElementById(<span class="string">"myNode"</span>);</span><br><span class="line"><span class="keyword">var</span> newNode = <span class="built_in">document</span>.importNode(oldNode, <span class="literal">true</span>);</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"container"</span>).appendChild(newNode);</span><br></pre></td></tr></table></figure>
<p>注意，这个方法仅拷贝节点，此时，节点存在于内存中，还需要插入当前文档中才能显示。</p>
<h3 id="node-cloneNode"><a href="#node-cloneNode" class="headerlink" title="node.cloneNode"></a>node.cloneNode</h3><p><code>node.cloneNode(deep)</code> 方法返回该节点的一个副本，<code>deep</code> 可选，表明是否采用深度克隆，如果为 true，则该节点的所有后代节点也都会被克隆，否则，只克隆该节点本身。</p>
<p>注意，克隆节点会克隆节点的所有属性，但是绑定的事件呢？我们来看一下：</p>
<p>首先看一下使用内联方式直接写在 HTML 标签上的 <code>onevent</code> 事件：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;div id=<span class="string">"old"</span>&gt;</span><br><span class="line">  &lt;p id=<span class="string">"clone"</span> onclick=<span class="string">"console.log('click clone')"</span>&gt;clone me.&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br><span class="line">&lt;div id=<span class="string">"new"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// cloneNode</span></span><br><span class="line"><span class="keyword">var</span> p = <span class="built_in">document</span>.getElementById(<span class="string">'clone'</span>);</span><br><span class="line"><span class="keyword">var</span> newDiv = <span class="built_in">document</span>.getElementById(<span class="string">'new'</span>);</span><br><span class="line">newDiv.appendChild(p.cloneNode(<span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// test</span></span><br><span class="line"><span class="comment">// 点击 #old &gt; #clone</span></span><br><span class="line"><span class="string">'click clone'</span></span><br><span class="line"><span class="comment">// 点击 #new &gt; #clone</span></span><br><span class="line"><span class="string">'click clone'</span></span><br><span class="line"><span class="comment">// on-event 属性绑定的事件保留</span></span><br></pre></td></tr></table></figure>
<p>结果显示，使用内联方式写在 HTML 上的事件是可以的，接下来看一下绑定在节点对象上的 <code>on-event</code> 事件：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;div id=<span class="string">"old"</span>&gt;</span><br><span class="line">  &lt;p id=<span class="string">"clone"</span>&gt;clone me.&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br><span class="line">&lt;div id=<span class="string">"new"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// cloneNode</span></span><br><span class="line"><span class="keyword">var</span> p = <span class="built_in">document</span>.getElementById(<span class="string">'clone'</span>);</span><br><span class="line"><span class="keyword">var</span> newDiv = <span class="built_in">document</span>.getElementById(<span class="string">'new'</span>);</span><br><span class="line">p.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'click clone'</span>)</span><br><span class="line">&#125;;</span><br><span class="line">newDiv.appendChild(p.cloneNode(<span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// test</span></span><br><span class="line"><span class="comment">// 点击 #old &gt; #clone</span></span><br><span class="line"><span class="string">'click clone'</span></span><br><span class="line"><span class="comment">// 点击 #new &gt; #clone</span></span><br><span class="line"><span class="comment">// do nothing</span></span><br><span class="line"><span class="comment">// 绑定在对象上的 on-event 事件没有克隆</span></span><br></pre></td></tr></table></figure>
<p>从测试结果来看，使用 js 绑定在节点对象上的 <code>on-event</code> 事件在克隆的副本并不包含事件处理程序。</p>
<p>接下来再看一下使用 <code>addEventListener</code> 方法添加在这个节点上的事件监听函数：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;div id=<span class="string">"old"</span>&gt;</span><br><span class="line">  &lt;p id=<span class="string">"clone"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"clone"</span>&gt;clone me.&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br><span class="line">&lt;div id=<span class="string">"new"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// cloneNode</span></span><br><span class="line"><span class="keyword">var</span> p = <span class="built_in">document</span>.getElementById(<span class="string">'move'</span>);</span><br><span class="line">p.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'click clone'</span>);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> newDiv = <span class="built_in">document</span>.getElementById(<span class="string">'new'</span>);</span><br><span class="line">newDiv.appendChild(p.cloneNode(<span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// test</span></span><br><span class="line"><span class="comment">// 点击 #old &gt; #clone</span></span><br><span class="line"><span class="string">'click clone'</span></span><br><span class="line"><span class="comment">// 点击 #new &gt; #clone</span></span><br><span class="line"><span class="comment">// do nothing</span></span><br><span class="line"><span class="comment">// addEventListener 绑定在对象上的事件没有克隆</span></span><br></pre></td></tr></table></figure>
<p>也就是说，副本节点只能绑定使用内联方式绑定的事件处理函数。</p>
<p>注意，这个拷贝的节点并不在文档中，需要自行添加到文档中。同时拷贝的节点有可能会导致节点的的 id 属性重复，最好修改新节点的 id，而 name 属性也可能重复，自行决定是否需要修改。</p>
<h2 id="节点修改"><a href="#节点修改" class="headerlink" title="节点修改"></a>节点修改</h2><p>和节点内容修改有关的接口主要有 <code>node.appendChild</code>、 <code>node.insertBefore</code>、 <code>node.removeChild</code>、 <code>node.replaceChild</code> 这四个接口。</p>
<h3 id="node-appendChild"><a href="#node-appendChild" class="headerlink" title="node.appendChild"></a>node.appendChild</h3><p><code>parentNode.appendChild(child)</code> 方法将一个节点（<code>child</code>）添加到指定父节点（<code>parentNode</code>）的子节点列表的末尾。本方法返回值为要插入的这个节点。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建一个新的段落p元素,然后添加到body的最尾部</span></span><br><span class="line"><span class="keyword">var</span> p = <span class="built_in">document</span>.createElement(<span class="string">'p'</span>);</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(p);</span><br><span class="line"></span><br><span class="line"><span class="comment">// p 节点为 body 元素的最后一个子节点</span></span><br></pre></td></tr></table></figure>
<p>注意，如果被插入的节点已经存在文档树中，则节点会被从原先的位置移除，并插入到新的位置，当然，被移动元素被绑定的事件也会被同步过去：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// html</span></span><br><span class="line">&lt;div id=<span class="string">"old"</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"move"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;div id=<span class="string">"new"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="built_in">document</span>.getElementById(<span class="string">'move'</span>);</span><br><span class="line"><span class="keyword">var</span> newDiv = <span class="built_in">document</span>.getElementById(<span class="string">'new'</span>);</span><br><span class="line">newDiv.appendChild(p);</span><br><span class="line"></span><br><span class="line"><span class="comment">// new html</span></span><br><span class="line">&lt;div id=<span class="string">"old"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;div id=<span class="string">"new"</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"move"</span>&gt;</span>move me.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>如果要保留原来的这个子节点的位置，则可以用 <code>Node.cloneNode</code> 方法复制出一个节点的副本，然后再插入到新位置：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// html</span></span><br><span class="line">&lt;div id=<span class="string">"old"</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"move"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;div id=<span class="string">"new"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="built_in">document</span>.getElementById(<span class="string">'move'</span>);</span><br><span class="line"><span class="keyword">var</span> newDiv = <span class="built_in">document</span>.getElementById(<span class="string">'new'</span>);</span><br><span class="line">newDiv.appendChild(p.cloneNode(<span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// new html</span></span><br><span class="line">&lt;div id=<span class="string">"old"</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"move"</span>&gt;</span>move me.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;div id=<span class="string">"new"</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"move"</span>&gt;</span>move me.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>这个方法只能将某个子节点插入到同一个文档的其他位置，如果你想跨文档插入，需要先调用 <code>document.importNode</code> 方法。</p>
<p>还有，如果 <code>appendChild</code> 方法的参数是 <code>DocumentFragment</code> 节点，那么插入的是 <code>DocumentFragment</code> 的所有子节点，而不是 <code>DocumentFragment</code> 节点本身。此时，返回值是一个空的 <code>DocumentFragment</code> 节点。</p>
<h3 id="node-insertBefore"><a href="#node-insertBefore" class="headerlink" title="node.insertBefore"></a>node.insertBefore</h3><p><code>parentNode.insertBefore(child, referenceNode)</code> 方法将一个节点（<code>child</code>）插入作为父节点（<code>parentNode</code>）的一个子节点，并且位置在参考节点（<code>referenceNode</code>）之前。</p>
<p>如果第二个参数 <code>referenceNode</code> 为 null，则插入位置为父节点的末尾：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">parentNode.insertBefore(node, <span class="literal">null</span>);</span><br><span class="line"><span class="comment">// 等价于</span></span><br><span class="line">parentNode.appendChild(node);</span><br></pre></td></tr></table></figure>
<p>注意，第二个参数为 null 时不能省略，否则会抛出异常：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Uncaught <span class="built_in">TypeError</span>: Failed to execute <span class="string">'insertBefore'</span> on <span class="string">'Node'</span>: <span class="number">2</span> <span class="built_in">arguments</span> required, but only <span class="number">1</span> present.</span><br></pre></td></tr></table></figure>
<p>使用这个方法可以模拟 <code>prependChild</code>，产生类似于 <code>appendChild</code> ，但是将节点插入作为指定父节点的第一个子节点：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Node.prototype.prependChild = <span class="function"><span class="keyword">function</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.insertBefore(node, <span class="keyword">this</span>.firstChild);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// html</span></span><br><span class="line">&lt;div id=<span class="string">"div"</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>原来的第一个子节点<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> div = <span class="built_in">document</span>.getElementById(<span class="string">'div'</span>);</span><br><span class="line"><span class="keyword">var</span> p = <span class="built_in">document</span>.createElement(<span class="string">'p'</span>);</span><br><span class="line">p.innerText = <span class="string">'第一个子节点'</span>;</span><br><span class="line">div.prependChild(p);</span><br><span class="line"></span><br><span class="line"><span class="comment">// new html</span></span><br><span class="line">&lt;div id=<span class="string">"div"</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>第一个子节点<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>原来的第一个子节点<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>使用这个方法还可以模拟 <code>insertAfter</code>，将节点要插在父节点的某个子节点后面：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Node.prototype.insertAfter = <span class="function"><span class="keyword">function</span>(<span class="params">node, referenceNode</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.insertBefore(node, referenceNode.nextSibling);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>和 <code>appendChild</code> 类似，如果插入的节点是文档中已经存在的节点，则会移动该节点到指定位置，并且保留其绑定的事件。</p>
<h3 id="node-removeChild"><a href="#node-removeChild" class="headerlink" title="node.removeChild"></a>node.removeChild</h3><p><code>parentNode.removeChild(child)</code> 删除指定父节点（<code>parentNode</code>）的一个子节点（<code>child</code>），并返回被删除的节点。</p>
<p>注意，这个方法是要在被删除的节点的父节点上调用的，而不是在被删除节点上调用的，如果参数节点不是当前节点的子节点，<code>removeChild</code> 方法将报错：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 通过 parentNode 属性直接删除自身</span></span><br><span class="line"><span class="keyword">var</span> node = <span class="built_in">document</span>.getElementById(<span class="string">'deleteDiv'</span>);</span><br><span class="line"><span class="keyword">if</span> (node.parentNode) &#123;</span><br><span class="line">  node.parentNode.removeChild(node);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 也可以封装以下作为一个方法直接使用:</span></span><br><span class="line">Node.prototype.remove = <span class="function"><span class="keyword">function</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (node.parentNode) &#123;</span><br><span class="line">    <span class="keyword">return</span> node.parentNode.removeChild(node);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Can not delete.'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">node.remove();</span><br></pre></td></tr></table></figure>
<p>使用这个方法也可以很简单的模拟 <code>removeAllChild</code> ：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Node.prototype.removeAllChild = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> deleteNode = []</span><br><span class="line">  <span class="keyword">while</span> (<span class="keyword">this</span>.firstChild) &#123;</span><br><span class="line">    deleteNode.push(<span class="keyword">this</span>.removeChild(<span class="keyword">this</span>.firstChild));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> deleteNode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>被移除的这个子节点仍然存在于内存中，只是不在当前文档的 DOM 中，仍然还可以被添加回文档中。但是如果不使用一个变量保存这个节点的引用，被删除的节点将不可达，会在某次垃圾回收被清除。</p>
<h3 id="node-replaceChild"><a href="#node-replaceChild" class="headerlink" title="node.replaceChild"></a>node.replaceChild</h3><p><code>parentNode.replaceChild(newChild, oldChild)</code> 方法用指定的节点（<code>newChild</code>）替换当前节点（<code>parentNode</code>）的一个子节点（<code>oldChild</code>），并返回被替换的节点（<code>oldChild</code>）。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line"> &lt;span id=<span class="string">"childSpan"</span>&gt;foo bar&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个空的span元素节点</span></span><br><span class="line"><span class="comment">// 没有id,没有任何属性和内容</span></span><br><span class="line"><span class="keyword">var</span> sp1 = <span class="built_in">document</span>.createElement(<span class="string">"span"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加一个id属性,值为'newSpan'，并添加文本内容</span></span><br><span class="line">sp1.setAttribute(<span class="string">"id"</span>, <span class="string">"newSpan"</span>);</span><br><span class="line">sp1.innerText = <span class="string">"新的span元素的内容."</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获得被替换节点和其父节点的引用.</span></span><br><span class="line"><span class="keyword">var</span> sp2 = <span class="built_in">document</span>.getElementById(<span class="string">"childSpan"</span>);</span><br><span class="line"><span class="keyword">var</span> parentDiv = sp2.parentNode;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用新的span元素sp1来替换掉sp2</span></span><br><span class="line">parentDiv.replaceChild(sp1, sp2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结果:</span></span><br><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;span id=<span class="string">"newSpan"</span>&gt;新的span元素的内容.&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br></pre></td></tr></table></figure>
<h3 id="元素修改"><a href="#元素修改" class="headerlink" title="元素修改"></a>元素修改</h3><p>元素是节点的一种，除了拥有上一节节点修改的一些方法外，元素还继承了 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/ParentNode" target="_blank" rel="external">ParentNode</a> 和 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/ChildNode" target="_blank" rel="external">ChildNode</a> 两个接口，因此拥有一些额外的修改方法：继承自 <code>ParentNode</code> 的 <code>ParentNode.append</code>、 <code>ParentNode.prepend</code> 和继承自 <code>ChildNode</code> 的 <code>ChildNode.before</code> 、 <code>ChildNode.after</code>、 <code>ChildNode.remove</code>、 <code>ChildNode.replaceWith</code> 这几个方法。</p>
<p>但是要注意的是，<code>ParentNode</code> 和 <code>ChildNode</code> 这两个都是原始接口，只能在实现了它的对象上使用。如果当前节点是父节点，就会继承 <code>ParentNode</code> 接口。由于只有元素节点（<code>Element</code>）、文档节点（<code>Document</code>）和文档片段节点（<code>DocumentFragment</code>）拥有子节点，因此只有这三类节点会继承 <code>ParentNode</code> 接口。如果一个节点有父节点，那么该节点就继承了 <code>ChildNode</code> 接口。</p>
<p>还要注意的是，这些方法目前都是实验性方法，浏览器的支持度还不太够，未来也可能发生变动，请谨慎使用。</p>
<h3 id="append-和-ParentNode-prepend"><a href="#append-和-ParentNode-prepend" class="headerlink" title="append 和 ParentNode.prepend"></a>append 和 ParentNode.prepend</h3><p><code>parentNode.append((Node/String) ...nodes)</code> 方法为指定节点的最后一个子节点之后插入一组节点。</p>
<p>和 <code>node.appendChild</code> 方法类似，不同点在于：</p>
<ol>
<li><code>append</code> 方法允许添加 string 做为参数，并将其包装为文本节点，而 <code>appendChild</code> 方法只能接受 Node 对象作为参数。</li>
<li><code>append</code> 方法允许添加多个参数，而 <code>appendChild</code> 方法只能接受一个节点。</li>
<li><code>append</code> 方法没有返回值，而 <code>appendChild</code> 方法返回被添加的节点。</li>
</ol>
<p><code>parentNode.prepend(...[Node/String])</code> 方法为指定节点的第一个子节点之后插入一组节点，其他内容和 <code>append</code> 方法类似，不再说明。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// old html</span></span><br><span class="line">&lt;div id=<span class="string">"div"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> div = <span class="built_in">document</span>.getElementById(<span class="string">'div'</span>);</span><br><span class="line"><span class="keyword">var</span> p = <span class="built_in">document</span>.createElement(<span class="string">"p"</span>);</span><br><span class="line"><span class="keyword">var</span> span = <span class="built_in">document</span>.createElement(<span class="string">"span"</span>);</span><br><span class="line">div.append(p);</span><br><span class="line">div.append(<span class="string">" End!"</span>);</span><br><span class="line">div.prepend(<span class="string">"Begin:"</span>);</span><br><span class="line">div.prepend(span);</span><br><span class="line"></span><br><span class="line"><span class="comment">// new html</span></span><br><span class="line">&lt;div id=<span class="string">"div"</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>Begin:<span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span> End!<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>使用 <code>appendChild</code> 和 <code>insertBefore</code> 可以很容易实现如下的 Polyfill：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDocFrag</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> argArr = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>),</span><br><span class="line">    docFrag = <span class="built_in">document</span>.createDocumentFragment();</span><br><span class="line">  </span><br><span class="line">  argArr.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">argItem</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> isNode = argItem <span class="keyword">instanceof</span> Node;</span><br><span class="line">    docFrag.appendChild(isNode ? argItem : <span class="built_in">document</span>.createTextNode(<span class="built_in">String</span>(argItem)));</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> docFrag</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  arr.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">    item.append = item.append || <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.appendChild(getDocFrag(<span class="built_in">arguments</span>));</span><br><span class="line">    &#125;;</span><br><span class="line">    item.prepend = item.prepend || <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.insertBefore(docFrag, <span class="keyword">this</span>.firstChild);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;)([Element.prototype, Document.prototype, DocumentFragment.prototype]);</span><br></pre></td></tr></table></figure>
<h3 id="ChildNode-before-和-ChildNode-after"><a href="#ChildNode-before-和-ChildNode-after" class="headerlink" title="ChildNode.before 和 ChildNode.after"></a>ChildNode.before 和 ChildNode.after</h3><p><code>childNode.before(...[Node/String])</code> 方法在指定节点的前面插入一组节点，<code>childNode.after(...[Node/String])</code> 方法在指定节点的后面插入一组节点，其他内容和 <code>parentNode.append</code> 方法类似，不再说明。</p>
<p><code>childNode.replaceWith((Node/String) ...nodes)</code> 用指定节点（<code>nodes</code>），替换当前节点（<code>childNode</code>）。</p>
<p>使用 <code>insertBefore</code> 可以很容易实现如下的 Polyfill：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  arr.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">    item.before || <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.parentNode.insertBefore(getDocFrag(<span class="built_in">arguments</span>), <span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    item.after || <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.parentNode.insertBefore(getDocFrag(<span class="built_in">arguments</span>), <span class="keyword">this</span>.nextSibling);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;)([Element.prototype, CharacterData.prototype, DocumentType.prototype]);</span><br></pre></td></tr></table></figure>
<h3 id="Element-insertAdjacentHTML、-Element-insertAdjacentText"><a href="#Element-insertAdjacentHTML、-Element-insertAdjacentText" class="headerlink" title="Element.insertAdjacentHTML、 Element.insertAdjacentText"></a>Element.insertAdjacentHTML、 Element.insertAdjacentText</h3><p>如果习惯了使用 <code>jQuery</code> ，就一定会对 jQuery 中的可以直接在参数中使用<code>Html</code> 的方式很是喜欢（比如 <code>$(ele).append(&#39;&lt;div&gt;content&lt;/div&gt;&#39;)</code>），而原生的 DOM 也有支持直参数为 <code>Html</code> 的方法。</p>
<blockquote>
<p>Element.insertAdjacentHTML(position, text)<br>Element.insertAdjacentText(position, text)</p>
</blockquote>
<ul>
<li>position: 这个参数指定了元素的插入位置，取值为以下4种：<ul>
<li>‘beforebegin’: 元素自身的前面，效果类似于 <code>childNode.before(ele)</code>。</li>
<li>‘afterbegin’: 插入元素内部的第一个 <strong>子节点</strong> 之前，效果类似于 <code>ParentNode.prepend(ele)</code>。</li>
<li>‘beforeend’: 插入元素内部的最后一个 <strong>子节点</strong> 之后，效果类似于 <code>ParentNode.append(ele)</code>。</li>
<li>‘afterend’: 元素自身的后面，效果类似于 <code>childNode.after(ele)</code>。</li>
</ul>
</li>
<li>text: 要插入的文本或者html字符串。</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// origin html</span></span><br><span class="line">&lt;div id=<span class="string">"outer"</span>&gt;</span><br><span class="line">  &lt;div&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const outer = document.getElementById('outer');</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">outer.insertAdjacentText('beforebegin', 'beforebegin 被插入这里');</span></span><br><span class="line"><span class="regexp">outer.insertAdjacentText('afterbegin', 'afterbegin 被插入这里');</span></span><br><span class="line"><span class="regexp">outer.insertAdjacentText('beforeend', 'beforeend 被插入这里');</span></span><br><span class="line"><span class="regexp">outer.insertAdjacentText('afterend', 'afterend 被插入这里');</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ after inserted.</span></span><br><span class="line"><span class="regexp">beforebegin 被插入这里</span></span><br><span class="line"><span class="regexp">&lt;div id="outer"&gt;</span></span><br><span class="line"><span class="regexp">  beforebegin 被插入这里</span></span><br><span class="line"><span class="regexp">  &lt;div&gt;&lt;/</span>div&gt;</span><br><span class="line">  beforebegin 被插入这里</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">beforebegin 被插入这里</span></span><br></pre></td></tr></table></figure>
<p>两个方法的区别在于 <code>insertAdjacentHTML</code> 方法会将字符串解析为 html，而 <code>insertAdjacentText</code> 不会做解析，因此在不需要解析的情况下（如添加纯文本）使用 <code>insertAdjacentText</code> 性能会更好。</p>
<h3 id="ChildNode-remove"><a href="#ChildNode-remove" class="headerlink" title="ChildNode.remove"></a>ChildNode.remove</h3><p><code>childNode.remove()</code> 方法把它从它所属的 DOM 树中删除，没有返回值，所以在删除前，需要先保留引用：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// old html</span></span><br><span class="line">&lt;div&gt;<span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"div"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> div = <span class="built_in">document</span>.getElementById(<span class="string">'div'</span>)</span><br><span class="line">div.remove();</span><br><span class="line"></span><br><span class="line"><span class="comment">// new html</span></span><br><span class="line">&lt;div&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>使用 <code>removeChild</code> 可以很容易实现如下的 Polyfill：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">arr</span>) </span>&#123;</span><br><span class="line">   arr.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">    item.remove = item.remove || <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.parentNode.removeChild(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;)([Element.prototype, CharacterData.prototype, DocumentType.prototype]);</span><br></pre></td></tr></table></figure>
<h3 id="ChildNode-replaceWith"><a href="#ChildNode-replaceWith" class="headerlink" title="ChildNode.replaceWith"></a>ChildNode.replaceWith</h3><p><code>childNode.replaceWith((Node/String) ...nodes)</code> 用指定节点（<code>nodes</code>），替换当前节点（<code>childNode</code>）。</p>
<p>使用 <code>replaceChild</code> 可以很容易实现如下的 Polyfill：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  arr.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">    item.replaceWith = item.replaceWith || <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.parentNode.replaceChild(getDocFrag(<span class="built_in">arguments</span>), <span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;)([Element.prototype, CharacterData.prototype, DocumentType.prototype]);</span><br></pre></td></tr></table></figure>
<h2 id="元素属性操作"><a href="#元素属性操作" class="headerlink" title="元素属性操作"></a>元素属性操作</h2><p>这些操作仅针对节点类型为 <code>Element</code> 的节点，即元素。</p>
<h3 id="读取属性"><a href="#读取属性" class="headerlink" title="读取属性"></a>读取属性</h3><p>读取属性可以使用 <code>element.getAttribute(attrName)</code>。如果指定的属性不存在，则返回 null 。（旧版本的浏览器可能会返回空字符串<code>&quot;&quot;</code>）</p>
<h3 id="修改属性"><a href="#修改属性" class="headerlink" title="修改属性"></a>修改属性</h3><p>修改属性可以使用 <code>element.setAttribute(attrName, attrValue)</code>。 如果此属性已经存在，则更新该值， 否则，将添加一个新的属性用指定的名称和值。</p>
<h3 id="删除属性"><a href="#删除属性" class="headerlink" title="删除属性"></a>删除属性</h3><p>删除属性可以使用 <code>element.removeAttribute(attrName)</code>。尝试删除不存在的属性并不会引发异常。</p>
<p>注意，当不需要某个属性的时候，优先使用 <code>removeAttribute</code>，而非使用 <code>setAttribute</code> 将属性值设置为 null。</p>
<h3 id="检查属性是否存在"><a href="#检查属性是否存在" class="headerlink" title="检查属性是否存在"></a>检查属性是否存在</h3><p>检查属性可以使用 <code>element.hasAttribute(attrName)</code>。</p>
<h3 id="修改元素节点对象的属性值"><a href="#修改元素节点对象的属性值" class="headerlink" title="修改元素节点对象的属性值"></a>修改元素节点对象的属性值</h3><p>当然，可能你已经见过这种操作元素属性的方法：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 修改属性</span></span><br><span class="line"><span class="keyword">var</span> form = <span class="built_in">document</span>.getElementById(<span class="string">'form'</span>);</span><br><span class="line">form.action = <span class="string">'/submit'</span>;</span><br><span class="line">form.method = <span class="string">'POST'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取属性</span></span><br><span class="line"><span class="built_in">console</span>.log(p.name)</span><br></pre></td></tr></table></figure>
<p>这种方法通过修改元素节点对象的属性值来修改元素的属性，但是有一定的局限性：</p>
<p>1.有些 HTML 的属性名是 Javascript 的保留字，比如 <code>for</code>、<code>class</code>，所以使用的时候必须更改：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">ele.htmlFor = <span class="string">"someValue"</span>; </span><br><span class="line">ele.className = <span class="string">"someValue"</span>;</span><br><span class="line"><span class="comment">// 等价于</span></span><br><span class="line">ele.setAttribute(<span class="string">'for'</span>, <span class="string">'someValue'</span>)</span><br><span class="line">ele.setAttribute(<span class="string">'class'</span>, <span class="string">'someValue'</span>)</span><br></pre></td></tr></table></figure>
<p>2.<code>getAttribute</code> 获取的 HTML 属性值都是字符串，而这种方法有时会对某些属性的值进行类型转换，比如，将字符串的 <code>true/false</code> 转为布尔类型，将 <code>onClick</code> 的值转为函数类型。</p>
<p>3.这种方法无法删除属性，即使用 <code>delete</code> 运算符不生效（自定义属性 <code>data-[attr-name]*</code> 是可以删除的）。</p>
<p>4.这种方法对非 HTML 支持的标准属性不生效，尽管这种非标准属性是不建议使用的：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// html</span></span><br><span class="line">&lt;div id=<span class="string">"test"</span> test=<span class="string">"true"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取非标准属性</span></span><br><span class="line"><span class="keyword">var</span> div = <span class="built_in">document</span>.getElementById(<span class="string">'test'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(div.test); <span class="comment">// undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(div.getAttribute(<span class="string">'test'</span>)); <span class="comment">// "true"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改非标准属性</span></span><br><span class="line">div.test = <span class="string">"false"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(div.getAttribute(<span class="string">'test'</span>)); <span class="comment">// "true"</span></span><br></pre></td></tr></table></figure>
<p>标准的自定义属性 <code>data-[attr-name]</code> 则使用 <code>ele.dataset.attrName</code>。</p>
<p>5.元素的属性名大小写不敏感，而 JavaScript 对象的属性名大小写敏感的，并且当属性名包括多个单词，会对属性名进行驼峰拼写法转换：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;button onclick=<span class="string">"doSthing"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">button.onClick = doSthing;</span><br></pre></td></tr></table></figure>
<p>优先使用上面提到的四个属性操作的方法进行属性的修改。</p>
<h3 id="获取元素的全部属性"><a href="#获取元素的全部属性" class="headerlink" title="获取元素的全部属性"></a>获取元素的全部属性</h3><p><code>Element.attributes</code> 属性返回该元素所有属性节点的一个<strong>实时集合</strong>。</p>
<p><strong>实时</strong> 指的是元素属性的任意变化都会反映在这个属性上：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// html</span></span><br><span class="line">&lt;div id=<span class="string">"test"</span> name=<span class="string">"test1"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> div = <span class="built_in">document</span>.getElementById(<span class="string">'test'</span>);</span><br><span class="line"><span class="keyword">var</span> attrs = div.attributes;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(attrs[<span class="number">1</span>].value); <span class="comment">// test1</span></span><br><span class="line">div.setAttribute(<span class="string">'name'</span>, <span class="string">'test2'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(attrs[<span class="number">1</span>].value); <span class="comment">// test2</span></span><br></pre></td></tr></table></figure>
<p><strong>集合</strong>是一个类数组结构，大概是这个样子的：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// html</span></span><br><span class="line">&lt;div id=<span class="string">"test"</span> name=<span class="string">"test1"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="built_in">console</span>.log(attrs);</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0</span>: Attr(id),</span><br><span class="line">  <span class="number">1</span>: Attr(name),</span><br><span class="line">  length: <span class="number">2</span>,</span><br><span class="line">  id: Attr(id),</span><br><span class="line">  name: Attr(name),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>集合</strong>的常用操作：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获取id属性的属性名：</span></span><br><span class="line">attrs.id.name</span><br><span class="line">attrs.id.nodeName</span><br><span class="line">attrs[<span class="number">0</span>].name</span><br><span class="line">attrs[<span class="number">0</span>].nodeName</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取id属性的属性值：</span></span><br><span class="line">attrs.id.value</span><br><span class="line">attrs[<span class="number">0</span>].value</span><br></pre></td></tr></table></figure>

        </div>
        
<footer class="article-footer">
  <div class="cc">
    <a class="cc-images" rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
      <img alt="知识共享许可协议" style="border-width:0" src="https://creativecommons.org/wp-content/themes/creativecommons.org/images/chooser_cc.png" />
      <img alt="知识共享许可协议" style="border-width:0" src="https://creativecommons.org/wp-content/themes/creativecommons.org/images/chooser_by.png" />
      <img alt="知识共享许可协议" style="border-width:0" src="https://creativecommons.org/wp-content/themes/creativecommons.org/images/chooser_nc.png" />
    </a>
    <span class="cc-text"> 本网站<strong>原创内容（非转载文章）</strong>采用 
      <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
        知识共享署名-非商业性使用 4.0 国际许可协议</a>
      进行许可。
    </span>
  </div>

  

    <div class="bdsharebuttonbox">
    <a href="#" class="bds_more" data-cmd="more">分享到：</a>
    <a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间">QQ空间</a>
    <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博">新浪微博</a>
    <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信">微信</a>
</div>
<script>
window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"16"},"share":{"bdSize":16} };with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script>
<style>
    .bdshare_popup_box {
        border-radius: 4px;
        border: #e1e1e1 solid 1px;
    }
    .bdshare-button-style0-16 a,
    .bdshare-button-style0-16 .bds_more {
        padding-left: 20px;
        margin: 6px 10px 6px 0;
    }
    .bdshare_dialog_list a,
    .bdshare_popup_list a,
    .bdshare_popup_bottom a {
        font-family: 'Microsoft Yahei';
    }
    .bdshare_popup_top {
        display: none;
    }
    .bdshare_popup_bottom {
        height: auto;
        padding: 5px;
    }
</style>



</footer>
    </div>
</article>

    <section id="comments">
    
        
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<!--  
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
-->
<div id="comment-container"></div>
<script>
  $(function() {
    var gitalk = new Gitalk({
      clientID: '010a558ff67c828f318a',
      clientSecret: '08a6f4955996cb3d6ecb5fdfb4d564a9297a264b',
      repo: 'tcatche.github.io.comments',
      owner: 'tcatche',
      admin: ['tcatche'],
      id: location.pathname.substr(0, 50),      // Ensure uniqueness and length less than 50
      distractionFreeMode: true  // Facebook-like distraction free mode,
      perPage: 30,
    })
    
    gitalk.render('comment-container')
    // var gitment = new Gitment({
    //   id: location.pathname, // 可选。默认为 location.href
    //   owner: 'tcatche',
    //   repo: 'tcatche.github.io.comments',
    //   oauth: {
    //     client_id: '010a558ff67c828f318a',
    //     client_secret: '08a6f4955996cb3d6ecb5fdfb4d564a9297a264b',
    //   },
    // })
    // gitment.render('comment-container')
  })
</script>
    
    </section>


              </div>
            </section>
            
          </div>
        </div>
      </div>
      <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo"></a>
                </h1>
                <p>&copy; 2018 tcatche</p>
                <p>Powered by <a href="//hexo.io/" target="_blank">Hexo</a>. </p>
                <p>Theme based <a href="//github.com/ppoffice" target="_blank">PPOffice</a> and modify by Tcatche. </p>
                <p>Hosted by <a  href="https://pages.github.com/">Github Pages</a>. </p>
            </div>
        </div>
    </div>
</footer>
    </div>
  </div>
  <div id="fixed">
  
  <i id="open-bookmark" class="fa fa-bookmark" name="list"></i>
  <div class="bookmark">
  <div class="bookmark-container">
    <div class="bookmark-header">
      <span>Table of Content</span>
      <span class="close">&times;</span>
    </div>
    <div class="bookmark-content">
    </div>
  </div>
</div>
<script src="/js/bookmark.js"></script>
  
  <i class="fa fa-search ins-search-icon" name="search"></i>
  <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-image-wrapper"></div>
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="想要查找什么..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>
  <i id="back-to-top" class="fa fa-arrow-up goto-top" name="goto top"></i>
</div>
  


    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    


<!-- Custom Scripts -->
<script src="/js/main.js"></script>

</body>
</html>
